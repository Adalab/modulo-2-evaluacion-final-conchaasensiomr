"use strict";const showsSearchButton=document.querySelector(".js-search-button");let showNameInput=document.querySelector(".js-search-show"),shows=[],favorites=[];function handleshowsSearchClick(){getDataFromApi().then(()=>paintShows())}function getDataFromApi(){return event.preventDefault(),shows=[],fetch("http://api.tvmaze.com/search/shows?q="+showNameInput.value).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++){const s=e[t];shows.push(s)}})}showsSearchButton.addEventListener("click",handleshowsSearchClick);const showsItems=document.querySelector(".js-shows-list"),msgNoResults=document.querySelector(".msg-no-results");function paintShows(){let e=showsItems;if(e.innerHTML="",shows.length>0){msgNoResults.classList.add("msg-no-results--hidden");for(let t=0;t<shows.length;t++){const s=shows[t];let o=null!==s.show.image?s.show.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV",a=document.createElement("li");e.appendChild(a);let n=document.createElement("article");n.classList.add("main__list--item","js-shows-items"),n.dataset.index=t,isFavorite(s)&&n.classList.add("selected"),n.id=s.show.id,a.appendChild(n),n.addEventListener("click",handleSetFavorite);let i=document.createElement("img");i.src=o,n.appendChild(i);let r=document.createElement("h3");r.classList.add("main__list--name","js-list-name"),r.appendChild(document.createTextNode(s.show.name)),n.appendChild(r)}}else msgNoResults.classList.remove("msg-no-results--hidden")}function isFavorite(e){return void 0!==favorites.find(t=>t.show.id===e.show.id)}const favoritesItems=document.querySelector(".js-favorites-list");function paintFavorites(){favoritesItems.innerHTML="";for(let e=0;e<favorites.length;e++){paintFavorite(favorites[e],e)}}function paintFavorite(e,t){let s=null!==e.show.image?e.show.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV",o=document.querySelector(".js-favorites-list"),a=document.createElement("li");a.classList.add("main__favorites--list","js-favorites-items"),o.appendChild(a),a.id=e.show.id;let n=document.createElement("article");n.classList.add("main__favorites--item"),n.dataset.index=t,a.appendChild(n);let i=document.createElement("img");i.src=s,n.appendChild(i);let r=document.createElement("h3");r.classList.add("main__list--title","js-favorites-name"),r.appendChild(document.createTextNode(e.show.name)),n.appendChild(r);let c=document.createElement("button");c.classList.add("remove__button","js-remove-button"),c.innerHTML="X",c.id=e.show.id,n.appendChild(c),c.addEventListener("click",handleRemoveFavorite)}function handleSetFavorite(e){e.currentTarget.classList.add("selected");const t=e.currentTarget.dataset.index,s=shows[t];isFavorite(s)?(e.currentTarget.classList.remove("selected"),handleRemoveFavorite(e)):(favorites.push(s),paintFavorite(s,t)),updateLocalStorage()}function handleRemoveFavorite(e){const t=parseInt(e.currentTarget.id),s=favorites.findIndex(e=>e.show.id===t);favorites.splice(s,1);const o=document.querySelectorAll(".js-favorites-items");for(const e of o)t===parseInt(e.id)&&e.remove();updateLocalStorage();const a=document.querySelectorAll(".js-shows-items");for(const e of a)t===parseInt(e.id)&&e.classList.remove("selected")}function updateLocalStorage(){localStorage.setItem("favorites",JSON.stringify(favorites))}function getFromLocalStorage(){favorites=JSON.parse(localStorage.getItem("favorites"))??[],paintFavorites()}const buttonReset=document.querySelector(".js-reset-button");function resetFavorites(){favorites=[],updateLocalStorage(),paintFavorites();const e=document.querySelectorAll(".js-shows-items");for(const t of e)t.classList.remove("selected")}buttonReset.addEventListener("click",resetFavorites),getFromLocalStorage();